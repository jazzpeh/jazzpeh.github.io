<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<link rel="icon" href="/assets/images/favicon.png">

<title>Data Preprocessing, the basics to Machine Learning | A 80% debugging, 20% coding programmer life</title>

<!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Data Preprocessing, the basics to Machine Learning | A 80% debugging, 20% coding programmer life</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Data Preprocessing, the basics to Machine Learning" />
<meta name="author" content="jazz" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="To start with machine learning, learning how to handle data is key, since machine learning is driven by data." />
<meta property="og:description" content="To start with machine learning, learning how to handle data is key, since machine learning is driven by data." />
<meta property="og:site_name" content="A 80% debugging, 20% coding programmer life" />
<meta property="og:image" content="/assets/images/data-preprocessing.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-05-03T00:00:00+08:00" />
<script type="application/ld+json">
{"url":"/data-preprocessing/","headline":"Data Preprocessing, the basics to Machine Learning","dateModified":"2020-05-03T00:00:00+08:00","datePublished":"2020-05-03T00:00:00+08:00","author":{"@type":"Person","name":"jazz"},"mainEntityOfPage":{"@type":"WebPage","@id":"/data-preprocessing/"},"description":"To start with machine learning, learning how to handle data is key, since machine learning is driven by data.","image":"/assets/images/data-preprocessing.jpg","@type":"BlogPosting","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


<link href="/assets/css/prism.css" rel="stylesheet">

<link href="/assets/css/theme.css" rel="stylesheet">

<script src="/assets/js/jquery.min.js"></script>

</head>




<body>
	<!-- defer loading of font and font awesome -->
	<noscript id="deferred-styles">
		<link href="https://fonts.googleapis.com/css?family=Sen:400,700&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
	</noscript>

<!-- Begin Sidebar Navigation
================================================== -->

<div class="sidebar">
</div>
<div class="nav-icon">
    <div class="hamburger-bar"></div>
</div>
<div id="blackover-nav" class="blackover"></div>
<nav id="menu">
    <ul>
        <h3>Navigation</h3>
        <li><a href="/">Home</a></li>
        <li><a href="/categories">Categories</a></li>
        <li><a href="/tags">Tags</a></li>
    </ul>
</nav>

<script src="/assets/js/lunr.js"></script>

<style>
    
</style>

<div class="wrap-search">
    <div class="d-flex align-items-center ml-auto">
        <i class="fas fa-search show-search"></i>
        <form class="bd-search ml-3" onSubmit="return lunr_search(document.getElementById('lunrsearch').value);">
            <input type="text" class="form-control bigradius text-small launch-modal-search" id="lunrsearch" name="q" maxlength="255" value="" placeholder="Type and enter..."/>
        </form>
    </div>
</div>

<div id="lunrsearchresults">
    <ul></ul>
</div>

<script src="/assets/js/lunrsearchengine.js"></script>


<!-- End Sidebar Navigation
================================================== -->

<div class="site-content ">

<div class="container">

    <!-- Site Logo/Name
    ================================================== -->

    


    <!-- Site Tag
    ================================================== -->
    

    <!-- Content
    ================================================== -->
    <div class="main-content">
        <div class="entry-header">
    <!-- Post Title -->
    <h1 class="posttitle">Data Preprocessing, the basics to Machine Learning</h1>
    <!-- Author & Date  Box -->
    
    
    <div class="d-flex align-items-center mt-4">
        <div>
            
            <img class="author-thumb" src="https://www.gravatar.com/avatar/4a1229bd40b1fcd153f70d056e6fed9a?s=250&d=mm&r=x" alt="Jazz">
            
        </div>            
        <div>
        Written by <a target="_blank" class="text-dark" href="https://www.linkedin.com/in/jazz-peh">Jazz</a> on 
        <span class="post-date"><time class="post-date" datetime="2020-05-03">03 May 2020</time></span>           
        
        </div>            
    </div>
    
</div>

<!-- Adsense under title if enabled from _config.yml (change your pub id and slot) -->


<!-- Featured Image -->

<div class="entry-featured-image">
    
    <img class="featured-image " src="/assets/images/data-preprocessing.jpg" alt="Data Preprocessing, the basics to Machine Learning">
    
</div>


<!-- Content -->
<!-- Post, Page Content
================================================== -->
<article class="article-post">
    <!-- Toc if any -->
    
    <!-- End Toc -->
    <p>To start with machine learning, learning how to handle data is key, since machine learning is driven by data.</p>

<h2 id="importing-the-libraries">Importing the libraries</h2>

<pre><code class="language-py3">import numpy as np
import matplotlib.pyplot as plt
import pandas as pd
</code></pre>

<blockquote>
  <p>Find out more about <a href="https://numpy.org/" target="_blank"><code>numpy</code></a>, <a href="https://matplotlib.org/" target="_blank"><code>matplotlib</code></a> and <a href="https://pandas.pydata.org/"><code>pandas</code></a></p>
</blockquote>

<h2 id="importing-the-dataset">Importing the dataset</h2>

<p><strong>Data.csv</strong></p>

<pre><code class="language-csv">Country,Age,Salary,Purchased
France,44,72000,No
Spain,27,48000,Yes
Germany,30,54000,No
Spain,38,61000,No
Germany,40,,Yes
France,35,58000,Yes
Spain,,52000,No
France,48,79000,Yes
Germany,50,83000,No
France,37,67000,Yes
</code></pre>

<p>So we’re going to separate the dataset into <code>matrix of features</code> and <code>dependent variable vectors</code>.</p>

<ul>
  <li><code>Matrix of features</code>: These are the columns which are being used to predict the dependent variable.</li>
  <li><code>Dependent variable vectors</code>: The column that that is being predicted.</li>
</ul>

<pre><code class="language-py3">dataset = pd.read_csv('Data.csv')
x = dataset.iloc(:, :-1).values
y = dataset.iloc(:, -1).values
</code></pre>

<blockquote>
  <p><strong>What does ’iloc’ exactly do?</strong></p>

  <p>It locates the column by its index. In other words, using ’iloc’ allows us to take columns by just taking their index.</p>
</blockquote>

<blockquote>
  <p><strong>Why do we create x and y separately?</strong></p>

  <p>Because we want to work with Numpy arrays, instead of Pandas dataframes. Numpy arrays are the most convenient format to work with when doing data preprocessing and building Machine Learning models. So we create two separate arrays, one that contains our independent variables (also called the input features), and another one that contains our dependent variable (what we want to predict).</p>
</blockquote>

<p><code>x</code> refers to the <code>matrix of features</code> which are actually the first 3 columns, <strong>Conutry</strong>, <strong>Age</strong> and <strong>Salary</strong>. And <code>y</code> is the <code>dependent variable vector</code> which will be predicted and is the last column <strong>Purchased</strong>. Hence, to further explain the code above, I’m using the <code>pandas</code> library to import <strong>Data.csv</strong> file and then using the <code>iloc</code> method which is available from the library to define the columns which are needed for <code>x</code> and <code>y</code> separately.</p>

<blockquote>
  <p>To understand more about how the semicolon (<code>:</code>) works in python, check out this <a href="https://stackoverflow.com/questions/509211/understanding-slice-notation"><code>Stackoverflow</code></a> explanation.</p>
</blockquote>

<pre><code class="language-py3">print(x)
# [['France' 44.0 72000.0]
#  ['Spain' 27.0 48000.0]
#  ['Germany' 30.0 54000.0]
#  ['Spain' 38.0 61000.0]
#  ['Germany' 40.0 nan]
#  ['France' 35.0 58000.0]
#  ['Spain' nan 52000.0]
#  ['France' 48.0 79000.0]
#  ['Germany' 50.0 83000.0]
#  ['France' 37.0 67000.0]]

print(y)
# ['No' 'Yes' 'No' 'No' 'Yes' 'Yes' 'No' 'Yes' 'No' 'Yes']
</code></pre>

<h2 id="taking-care-of-missing-data">Taking care of missing data</h2>

<p>There are 3 ways to handle missing data in any cell:</p>

<ul>
  <li>Replace by <em>average (mean)</em>.</li>
  <li>Replace by <em>median</em>.</li>
  <li>Replace by <em>most frequent value</em>.</li>
</ul>

<blockquote>
  <p>Replacing missing values by average (mean) is the most classic and recommended way.</p>
</blockquote>

<pre><code class="language-py3">from sklearn.impute import SimpleImputer
imputer = SimpleImputer(missing_values=np.nan, strategy='mean')
imputer.fit(x[:, 1:3])
x[:, 1:3] = imputer.transform(x[:, 1:3])
</code></pre>

<p>To handle missing data, we make use of the <a href="https://scikit-learn.org/stable/" target="_blank"><code>scikit-learn</code></a> library.</p>

<blockquote>
  <p><strong>What is the difference between fit and transform?</strong></p>

  <p>The fit part is used to extract some info of the data on which the object is applied (here, Imputer will spot the missing values and get the mean of the column). Then, the transform part is used to apply some transformation (here, Imputer will replace the missing value by the mean).</p>
</blockquote>

<pre><code class="language-py3">print(x)
# [['France' 44.0 72000.0]
#  ['Spain' 27.0 48000.0]
#  ['Germany' 30.0 54000.0]
#  ['Spain' 38.0 61000.0]
#  ['Germany' 40.0 63777.77777777778]
#  ['France' 35.0 58000.0]
#  ['Spain' 38.77777777777778 52000.0]
#  ['France' 48.0 79000.0]
#  ['Germany' 50.0 83000.0]
#  ['France' 37.0 67000.0]]
</code></pre>

<h2 id="encoding-categorical-data">Encoding categorical data</h2>

<p>Encoding is a technique to convert string values into numerical values. Why is encoding needed? Since there are string values in the dataset, it will be difficult for machine learning model to compute some correlations between these columns.</p>

<h3 id="encoding-the-independent-variable">Encoding the Independent Variable</h3>

<p>One idea would be to encode France into 0, Spain into 1 and Germany into 2. However the machine learning model would understand that because France is 0, Spain is 1 and Germany is 2, there is a numerical order between these countries. That is absolutely not the case. There is not a relationship order between these countries. We want to avoid to have such an interpretation for the model because that would cause some misinterpreted correlations between features and the prediction outcome. Hence a better technique would be <code>One hot encoding</code>.</p>

<p>For example, the country column would be turned into 3 columns because there are actually 3 different classes in the country column. So if there are 5 different countries in the country column, it would then be turned into 5 columns. <code>One hot encoding</code> consists of creating binary vectors for each of the countries. Hence, France would have the vector <strong>1 0 0</strong>, Spain would be <strong>0 1 0</strong>, and Germarny <strong>0 0 1</strong>. There would then be no numerical order between these countries.</p>

<blockquote>
  <p><code>One hot encoding</code> is extremely useful and popular method to use when the data sets contain categorical variables.</p>
</blockquote>

<pre><code class="language-py3">from sklearn.compose import ColumnTransformer
from sklearn.preprocessing import OneHotEncoder
ct = ColumnTransformer(transformers=[('encoder', OneHotEncoder(), [0])], remainder='passthrough')
x = np.array(ct.fit_transform(x))

print(x)
# [[1.0 0.0 0.0 44.0 72000.0]
#  [0.0 0.0 1.0 27.0 48000.0]
#  [0.0 1.0 0.0 30.0 54000.0]
#  [0.0 0.0 1.0 38.0 61000.0]
#  [0.0 1.0 0.0 40.0 63777.77777777778]
#  [1.0 0.0 0.0 35.0 58000.0]
#  [0.0 0.0 1.0 38.77777777777778 52000.0]
#  [1.0 0.0 0.0 48.0 79000.0]
#  [0.0 1.0 0.0 50.0 83000.0]
#  [1.0 0.0 0.0 37.0 67000.0]]
</code></pre>

<blockquote>
  <p><strong>What do the two ’fit_transform’ methods do?</strong></p>

  <p>When the ’fit_transform()’ method is called from the LabelEncoder() class, it transforms the categories strings into integers. For example, it transforms France, Spain and Germany into 0, 1 and 2. Then, when the ’fit_transform()’ method is called from the OneHotEncoder() class, it creates separate columns for each different labels with binary values 0 and 1. Those separate columns are the dummy variables.</p>
</blockquote>

<h3 id="encoding-the-dependent-variable">Encoding the Dependent Variable</h3>

<pre><code class="language-py3">from sklearn.preprocessing import LabelEncoder
le = LabelEncoder()
y = le.fit_transform(y)

print(y)
# [0 1 0 0 1 1 0 1 0 1]
</code></pre>

<h2 id="splitting-the-dataset-into-the-training-set-and-test-set">Splitting the dataset into the Training set and Test set</h2>

<ul>
  <li><strong>Training set</strong>. Used to train the model.</li>
  <li><strong>Test Set</strong>. Used to test the model performance.</li>
</ul>

<p>The recommended ratio is <em>80%</em> of the dataset to be used for training and <em>20%</em> and test.</p>

<blockquote>
  <p><strong>Why dataset spliting comes first and feature scale later?</strong></p>

  <p>Feature scaling is a technique to get the mean and standard deviation of the feature, so if we apply feature scaling before splitting, then it will actually get the mean and standard deviation of all the values including the ones in the test set and since the test set is not something we’re supposed to have for data in production, it would then caused information leakage on the test set. Hence, tt is to prevent information leakage on the test set which we’re not supposed to have until the training is done.</p>
</blockquote>

<blockquote>
  <p><strong>Why do we split on the dependent variable?</strong></p>

  <p>Because we want to have well distributed values of the dependent variable in the training and test set. For example if we only had the same value of the dependent variable in the training set, our model wouldn’t be able to learn any correlation between the independent and dependent variables.</p>
</blockquote>

<pre><code class="language-py3">from sklearn.model_selection import train_test_split
x_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.2, random_state=1)

print(x_train)
# [[0.0 0.0 1.0 38.77777777777778 52000.0]
#  [0.0 1.0 0.0 40.0 63777.77777777778]
#  [1.0 0.0 0.0 44.0 72000.0]
#  [0.0 0.0 1.0 38.0 61000.0]
#  [0.0 0.0 1.0 27.0 48000.0]
#  [1.0 0.0 0.0 48.0 79000.0]
#  [0.0 1.0 0.0 50.0 83000.0]
#  [1.0 0.0 0.0 35.0 58000.0]]

print(x_test)
# [[0.0 1.0 0.0 30.0 54000.0]
#  [1.0 0.0 0.0 37.0 67000.0]]

print(y_train)
# [0 1 0 0 1 1 0 1]

print(y_test)
# [0 1]
</code></pre>

<h2 id="feature-scaling">Feature Scaling</h2>

<p>There are 2 ways to scale the features. And the most recommended way is <code>Standardisation</code>.</p>

<pre><code class="language-text">Standardisation =  x - mean(+x) / standard deviation(x)
Normalisation = x - min(x) / max(x) = min(x)
</code></pre>

<ul>
  <li><code>Standardisation</code> will always work all the time (-3:+3, -2:+2 etc)</li>
  <li><code>Normalisation</code> is recommend when you have a normal distribution in most of the features (0:1)</li>
</ul>

<blockquote>
  <p><strong>Do we have to apply feature scaling to the dummy variables in the matrix of features</strong></p>

  <p>No. The goal of standardisation or feature scaling in general is to have all the values of the features in the same range. Hence, if we apply standardisation to the dummy variables, we will get nonsense numerical values which will make it incapable to tell which couple of three values here correspond to the which country. And also the dummy variables are already in the same range as the scaling. Hence, only apply feature scaling to the numerical values.</p>
</blockquote>

<pre><code class="language-py3">from sklearn.preprocessing import StandardScaler
sc = StandardScaler()
x_train[:, 3:] = sc.fit_transform(x_train[:, 3:])

# Use the same scale as x_train and just transform the test to apply the forumla
x_test[:, 3:] = sc.transform(x_test[:, 3:])

print(x_train)
# [[0.0 0.0 1.0 -0.19159184384578545 -1.0781259408412425]
#  [0.0 1.0 0.0 -0.014117293757057777 -0.07013167641635372]
#  [1.0 0.0 0.0 0.566708506533324 0.633562432710455]
#  [0.0 0.0 1.0 -0.30453019390224867 -0.30786617274297867]
#  [0.0 0.0 1.0 -1.9018011447007988 -1.420463615551582]
#  [1.0 0.0 0.0 1.1475343068237058 1.232653363453549]
#  [0.0 1.0 0.0 1.4379472069688968 1.5749910381638885]
#  [1.0 0.0 0.0 -0.7401495441200351 -0.5646194287757332]]

print(x_test)
# [[0.0 1.0 0.0 -1.4661817944830124 -0.9069571034860727]
#  [1.0 0.0 0.0 -0.44973664397484414 0.2056403393225306]]
</code></pre>

</article>

<!-- Rating -->


<!-- Author Box if enabled from _config.yml -->
<!-- Author Box -->




<!-- Comments if not disabled with comments: false -->
<!-- Comments
================================================== -->
 
<div class="comments">
    <button class="btn btn-dark show-comments">Load Comments</button>         
    <div id="comments">  
        <h4 class="mb-4">Comments</h4>                 
            <section class="disqus">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_shortname = 'demowebsite'; 
        var disqus_developer = 0;
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = window.location.protocol + '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>
     
    <div class="clearfix"></div>              
    </div>    
</div>       


<!-- Share -->
<div class="share">
    <p>
        Share
    </p>
    <ul>
        <li class="ml-1 mr-1">
            <a target="_blank" href="https://twitter.com/intent/tweet?text=Data Preprocessing, the basics to Machine Learning&url=/data-preprocessing/" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                <i class="fab fa-twitter"></i>
            </a>
        </li>

        <li class="ml-1 mr-1">
            <a target="_blank" href="https://facebook.com/sharer.php?u=/data-preprocessing/" onclick="window.open(this.href, 'facebook-share', 'width=550,height=435');return false;">
                <i class="fab fa-facebook-f"></i>
            </a>
        </li>

        <li class="ml-1 mr-1">
            <a target="_blank" href="https://www.linkedin.com/shareArticle?mini=true&url=/data-preprocessing/" onclick="window.open(this.href, 'width=550,height=435');return false;">
                <i class="fab fa-linkedin-in"></i>
            </a>
        </li>

    </ul>
</div>


<!-- Related Post -->
<!-- Related Posts
================================================== -->
<div class=" related-posts ">

    
    <h2 class="text-center mb-4">Explore more like this</h2>
    

    <div class="d-flex justify-content-center align-items-center flex-wrap">

    <!-- Categories -->
    
    
    <a class="smoothscroll badge badge-primary text-capitalize" href="/categories#Machine-Learning">Machine Learning</a>
    

    <!-- Tags -->
    
    
    <a class="smoothscroll badge badge-primary text-capitalize" href="/tags#Data-Preprocessing">Data Preprocessing</a>
    

    </div>

    
    
    
    <div class="blog-grid-container">
        

            
            

            

            

        

            
            

            

            

        

            
            

            

            

        

            
            

            

            

        

            
            

            

            

        

            
            

            

            

        

            
            

            

            

        

            
            

            

            

        

            
            

            

            

        

            
            

            

            

        

            
            

            

            

        

            
            

            

            

        

            
            

            

            

        

            
            

            

            
            <!-- begin post -->




<div class="blog-grid-item">
    <div class="card h-100 w-100">
        <div
            class="maxthumb"
            
        >
            <a
                href="/simple-linear-regression/"
                
            >
                

                    
                        <img class="img-thumb" src="/assets/images/simple-linear-regression.jpg" alt="Simple Linear Regression">
                    

                
            </a>
        </div>
        <div class="card-body">
            <h2 class="card-title">
                <a class="text-dark" href="/simple-linear-regression/">Simple Linear Regression</a>
                
            </h2>
            <h4 class="card-text">Let’s explore how we can implement Simple Linear Regression in this post.
</h4>
        </div>
        <div class="card-footer bg-white">
            <div class="wrapfooter">
                
                <span class="meta-footer-thumb">
                
                <img class="author-thumb" src="https://www.gravatar.com/avatar/4a1229bd40b1fcd153f70d056e6fed9a?s=250&d=mm&r=x" alt="Jazz">
                
                </span>
                <span class="author-meta">
                <span class="post-name"><a target="_blank" href="https://www.linkedin.com/in/jazz-peh">Jazz</a></span>
                
                <span class="post-date">05 May 2020</span>
                </span>
                <div class="clearfix"></div>
            </div>
        </div>
    </div>
</div>
<!-- end post -->
            
            
            

        

            
            

            

            

        

            
            

            

            

        

            
            

            

            

        

            
            

            

            

        

            
            

            

            

        
        </div>
</div>

<!-- Review with LD-JSON, adapt it for your needs if you like, but make sure you test the generated HTML source code first: 
https://search.google.com/structured-data/testing-tool/u/0/
================================================== -->

    </div>

    

</div>

<!-- Begin Footer
================================================== -->
<footer class="footer">
    <div class="container">
        <div class="row">
            <div class="col-md-6 col-sm-12 text-center text-lg-left">
                Copyright © 2020 Jazz Peh
                <div class="social">
                    
                    <a class="social-icon" href="https://github.com/jazzpeh" target="_blank"><i class="fab fa-github"></i></a>
                    
                    
                        <a class="social-icon" href="https://www.linkedin.com/in/jazz-peh/" target="_blank"><i class="fab fa-linkedin"></i></a>
                    
                </div>
            </div>
            <div class="col-md-6 col-sm-12 text-center text-lg-right">
                <a target="_blank" href="https://www.wowthemes.net/memoirs-free-jekyll-theme/">Memoirs Jekyll Theme</a> by WowThemes.net
            </div>
        </div>
    </div>
</footer>
<!-- End Footer
================================================== -->

</div> <!-- /.site-content -->

<!-- Scripts (if you need bootstrap.js, please add it yourself. I didn't use it for performance reasons, it was not needed in this theme)
================================================== -->

<script src="/assets/js/prism.js"></script>

<script src="/assets/js/theme.js"></script>




<script id="dsq-count-scr" src="//demowebsite.disqus.com/count.js"></script>


<script type="text/javascript" src="/assets/js/main.js" async></script>

</body>
</html>
